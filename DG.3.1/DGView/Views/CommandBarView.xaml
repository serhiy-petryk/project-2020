<UserControl x:Class="DGView.Views.CommandBarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:common="clr-namespace:DGView.Common"
             xmlns:controls="clr-namespace:DGView.Controls"
             mc:Ignorable="d"
             BorderThickness="0 0 0 1" BorderBrush="{StaticResource Mwi.WindowBar.BorderBrush}"
             Loaded="CommandBarView_OnLoaded">

    <UserControl.Resources>
        <Style TargetType="Path">
            <Setter Property="Fill" Value="{DynamicResource Mwi.WindowBar.ForegroundBrush}"/>
            <Setter Property="Width" Value="24"/>
            <Setter Property="Height" Value="24"/>
        </Style>
        <Style TargetType="StackPanel">
            <Setter Property="Margin" Value="0 0 3 0"/>
            <Setter Property="Orientation" Value="Horizontal"/>
        </Style>

        <Path x:Key="DownArrowPath" x:Shared="False" Width="8.5" Height="3" Data="M2.5,0L8.5,0 5.5,3z" VerticalAlignment="Center"/>
        <Path x:Key="SettingsIcon" x:Shared="false" Width="24" Height="24" Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
        <StackPanel x:Key="OpenIcon" x:Shared="False">
            <Path Data="M12,10L8,14H11V20H13V14H16M19,4H5C3.89,4 3,4.9 3,6V18A2,2 0 0,0 5,20H9V18H5V8H19V18H15V20H19A2,2 0 0,0 21,18V6A2,2 0 0,0 19,4Z"/>
            <StaticResource ResourceKey="DownArrowPath"/>
        </StackPanel>
        <Viewbox x:Key="SaveIcon" x:Shared="false" Width="20" Height="20">
            <Path Data="M8,16H16V17H8 Z M8,19H16V20H8 Z M12,2H15V6H12 Z M19,0H1C0.4,0,0,0.4,0,1v22c0,0.6,0.4,1,1,1h22c0.6,0,1-0.4,1-1V5L19,0z M6,1h10v6H6V1z M18,22H6v-8h12V22z M22,22h-3v-9H5   v9H2V2h3v6h12V2h1.5L22,5.5V22z"/>
        </Viewbox>

        <Geometry x:Key="GridOnGeometry">M10,4V8H14V4H10M16,4V8H20V4H16M16,10V14H20V10H16M16,16V20H20V16H16M14,20V16H10V20H14M8,20V16H4V20H8M8,14V10H4V14H8M8,8V4H4V8H8M10,14H14V10H10V14M4,2H20A2,2 0 0,1 22,4V20A2,2 0 0,1 20,22H4C2.92,22 2,21.1 2,20V4A2,2 0 0,1 4,2Z</Geometry>
        <Geometry x:Key="GridOffGeometry">M0,2.77L1.28,1.5L22.5,22.72L21.23,24L19.23,22H4C2.92,22 2,21.1 2,20V4.77L0,2.77M10,4V7.68L8,5.68V4H6.32L4.32,2H20A2,2 0 0,1 22,4V19.7L20,17.7V16H18.32L16.32,14H20V10H16V13.68L14,11.68V10H12.32L10.32,8H14V4H10M16,4V8H20V4H16M16,20H17.23L16,18.77V20M4,8H5.23L4,6.77V8M10,14H11.23L10,12.77V14M14,20V16.77L13.23,16H10V20H14M8,20V16H4V20H8M8,14V10.77L7.23,10H4V14H8Z</Geometry>

        <Viewbox x:Key="FontIcon" x:Shared="false" Width="20" Height="20">
            <Path Width="1792" Height="1792" Data="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0 57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29 31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15 34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 4-.5 13t-.5 13q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0 12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11 2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0 22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58 0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"/>
        </Viewbox>

        <StackPanel x:Key="GroupLayerIcon" x:Shared="False">
            <Path Data="M12,16L19.36,10.27L21,9L12,2L3,9L4.63,10.27M12,18.54L4.62,12.81L3,14.07L12,21.07L21,14.07L19.37,12.8L12,18.54Z"/>
            <StaticResource ResourceKey="DownArrowPath" />
        </StackPanel>

        <Viewbox x:Key="SortAscendingIcon" x:Shared="false" Width="24" Height="24">
            <Path Width="512" Height="512" Data="M 115.78125 32.0625 C 108.78044 46.46089 102.03142 61.21258 95.53125 76.3125 C 89.030945 91.41274 82.420358 107.35646 75.71875 124.15625 C 69.017051 140.95628 62.185149 158.87484 55.1875 177.875 C 48.189801 196.87529 40.800282 217.56887 33 239.96875 L 81.59375 239.96875 C 83.797065 232.76661 86.23969 225.34889 88.9375 217.75 C 91.635194 210.15116 94.27484 202.56767 96.875 194.96875 L 177.875 194.96875 C 180.47494 202.56767 183.14584 210.15116 185.84375 217.75 C 188.54135 225.34889 190.98397 232.76661 193.1875 239.96875 L 243.28125 239.96875 C 235.48075 217.56887 228.09429 196.87529 221.09375 177.875 C 214.09284 158.87484 207.22968 140.95628 200.53125 124.15625 C 193.83248 107.35646 187.19455 91.41274 180.59375 76.3125 C 173.99265 61.21258 167.26793 46.46089 160.46875 32.0625 L 115.78125 32.0625 z M 137.09375 79.15625 C 138.29603 82.15934 139.87599 86.2687 141.875 91.46875 C 143.87378 96.66908 146.23658 102.66957 148.9375 109.46875 C 151.63818 116.26819 154.46874 123.76879 157.46875 131.96875 C 160.46849 140.16892 163.58287 148.77865 166.78125 157.78125 L 107.6875 157.78125 C 110.88566 148.77865 114.02433 140.16892 117.125 131.96875 C 120.22549 123.76879 123.08731 116.26819 125.6875 109.46875 C 128.28751 102.66957 130.59475 96.66908 132.59375 91.46875 C 134.59254 86.2687 136.09266 82.15934 137.09375 79.15625 z M 355.125 110.0625 C 353.16156 110.06276 351.20086 111.14884 349.8125 113 C 348.42413 114.85115 347.62519 117.44458 347.625 120.0625 L 347.625 306.0625 L 320.34375 278.78125 C 318.51036 276.94915 315.90412 275.89905 313.3125 275.9375 C 310.81985 275.9765 308.35712 277.01905 306.59375 278.78125 L 279.09375 306.28125 C 277.29345 308.08088 276.25 310.61072 276.25 313.15625 C 276.25 315.70177 277.29345 318.23161 279.09375 320.03125 L 370.75 411.65625 C 372.54965 413.45653 375.07948 414.5 377.625 414.5 C 380.17053 414.5 382.70037 413.45653 384.5 411.65625 L 476.125 320.03125 C 477.92528 318.23162 479 315.70178 479 313.15625 C 479 310.61073 477.92528 308.08089 476.125 306.28125 L 448.625 278.78125 C 446.82593 276.9856 444.32311 275.9375 441.78125 275.9375 C 439.23941 275.9375 436.70533 276.9856 434.90625 278.78125 L 407.625 306.0625 L 407.625 120.0625 C 407.6248 117.44458 406.82587 114.85115 405.4375 113 C 404.04913 111.14884 402.08844 110.06276 400.125 110.0625 L 355.125 110.0625 z M 61.1875 272.03125 L 61.1875 311.34375 L 154.46875 311.34375 C 146.66836 320.74333 138.22525 331.37954 129.125 343.28125 C 120.02459 355.18323 111.0794 367.48925 102.28125 380.1875 C 93.482985 392.88595 85.039878 405.46882 76.9375 417.96875 C 68.83506 430.46883 61.971907 441.82625 56.375 452.03125 L 56.375 479.9375 L 219.875 479.9375 L 219.875 440.625 L 113.96875 440.625 C 121.17083 428.6255 129.39262 416.04266 138.59375 402.84375 C 147.7947 389.64498 157.10047 376.83689 166.5 364.4375 C 175.89928 352.03833 184.9829 340.59499 193.78125 330.09375 C 202.57932 319.59281 210.191 311.03557 216.59375 304.4375 L 216.59375 272.03125 L 61.1875 272.03125 z"/>
        </Viewbox>
        <Viewbox x:Key="SortDescendingIcon" x:Shared="false" Width="24" Height="24">
            <Path Width="512" Height="512" Data="M 61.1875 32.0625 L 61.1875 71.375 L 154.46875 71.375 C 146.66836 80.77458 138.22525 91.41079 129.125 103.3125 C 120.02459 115.21448 111.0794 127.5205 102.28125 140.21875 C 93.482985 152.9172 85.039878 165.50007 76.9375 178 C 68.83506 190.50004 61.971907 201.85746 56.375 212.0625 L 56.375 239.96875 L 219.875 239.96875 L 219.875 200.65625 L 113.96875 200.65625 C 121.17083 188.65679 129.39262 176.07391 138.59375 162.875 C 147.7947 149.67623 157.10047 136.86814 166.5 124.46875 C 175.89928 112.06958 184.9829 100.62624 193.78125 90.125 C 202.57932 79.62406 210.191 71.06682 216.59375 64.46875 L 216.59375 32.0625 L 61.1875 32.0625 z M 355.125 110.0625 C 353.16156 110.06276 351.20086 111.14884 349.8125 113 C 348.42413 114.85115 347.62519 117.44458 347.625 120.0625 L 347.625 306.0625 L 320.34375 278.78125 C 318.51036 276.94915 315.90412 275.89905 313.3125 275.9375 C 310.81985 275.9765 308.35712 277.01905 306.59375 278.78125 L 279.09375 306.28125 C 277.29345 308.08088 276.25 310.61072 276.25 313.15625 C 276.25 315.70177 277.29345 318.23161 279.09375 320.03125 L 370.75 411.65625 C 372.54965 413.45653 375.07948 414.5 377.625 414.5 C 380.17053 414.5 382.70037 413.45653 384.5 411.65625 L 476.125 320.03125 C 477.92528 318.23162 479 315.70178 479 313.15625 C 479 310.61073 477.92528 308.08089 476.125 306.28125 L 448.625 278.78125 C 446.82593 276.9856 444.32311 275.9375 441.78125 275.9375 C 439.23941 275.9375 436.70533 276.9856 434.90625 278.78125 L 407.625 306.0625 L 407.625 120.0625 C 407.6248 117.44458 406.82587 114.85115 405.4375 113 C 404.04913 111.14884 402.08844 110.06276 400.125 110.0625 L 355.125 110.0625 z M 115.78125 272.03125 C 108.78044 286.42964 102.03142 301.18133 95.53125 316.28125 C 89.030945 331.38149 82.420358 347.32521 75.71875 364.125 C 69.017051 380.92503 62.185149 398.84359 55.1875 417.84375 C 48.189801 436.84404 40.800282 457.53762 33 479.9375 L 81.59375 479.9375 C 83.797065 472.73536 86.23969 465.31764 88.9375 457.71875 C 91.635194 450.11991 94.27484 442.53642 96.875 434.9375 L 177.875 434.9375 C 180.47495 442.53642 183.14584 450.11991 185.84375 457.71875 C 188.54135 465.31764 190.98397 472.73536 193.1875 479.9375 L 243.28125 479.9375 C 235.48075 457.53762 228.09429 436.84404 221.09375 417.84375 C 214.09284 398.84359 207.22968 380.92503 200.53125 364.125 C 193.83248 347.32521 187.19455 331.38149 180.59375 316.28125 C 173.99265 301.18133 167.26793 286.42964 160.46875 272.03125 L 115.78125 272.03125 z M 137.09375 319.125 C 138.29603 322.12809 139.87599 326.23745 141.875 331.4375 C 143.87379 336.63783 146.23658 342.63832 148.9375 349.4375 C 151.63818 356.23694 154.46874 363.73754 157.46875 371.9375 C 160.46849 380.13767 163.58287 388.7474 166.78125 397.75 L 107.6875 397.75 C 110.88566 388.7474 114.02433 380.13767 117.125 371.9375 C 120.22549 363.73754 123.08731 356.23694 125.6875 349.4375 C 128.2875 342.63832 130.59475 336.63783 132.59375 331.4375 C 134.59255 326.23745 136.09267 322.12809 137.09375 319.125 z"/>
        </Viewbox>
        <Viewbox x:Key="SortOffIcon" x:Shared="false" Width="24" Height="24">
            <Path Width="512" Height="512" Data="M 315 444 L 375 384 L 315 324 L 345 294 L 405 353 L 466 294 L 496 324 L 436 384 L 496 444 L 466 474 L 405 414 L 345 474 L 315 444 M 115.78125 32.0625 C 108.78044 46.46089 102.03142 61.21258 95.53125 76.3125 C 89.030945 91.41274 82.420358 107.35646 75.71875 124.15625 C 69.017051 140.95628 62.185149 158.87484 55.1875 177.875 C 48.189801 196.87529 40.800282 217.56887 33 239.96875 L 81.59375 239.96875 C 83.797065 232.76661 86.23969 225.34889 88.9375 217.75 C 91.635194 210.15116 94.27484 202.56767 96.875 194.96875 L 177.875 194.96875 C 180.47494 202.56767 183.14584 210.15116 185.84375 217.75 C 188.54135 225.34889 190.98397 232.76661 193.1875 239.96875 L 243.28125 239.96875 C 235.48075 217.56887 228.09429 196.87529 221.09375 177.875 C 214.09284 158.87484 207.22968 140.95628 200.53125 124.15625 C 193.83248 107.35646 187.19455 91.41274 180.59375 76.3125 C 173.99265 61.21258 167.26793 46.46089 160.46875 32.0625 L 115.78125 32.0625 z M 137.09375 79.15625 C 138.29603 82.15934 139.87599 86.2687 141.875 91.46875 C 143.87378 96.66908 146.23658 102.66957 148.9375 109.46875 C 151.63818 116.26819 154.46874 123.76879 157.46875 131.96875 C 160.46849 140.16892 163.58287 148.77865 166.78125 157.78125 L 107.6875 157.78125 C 110.88566 148.77865 114.02433 140.16892 117.125 131.96875 C 120.22549 123.76879 123.08731 116.26819 125.6875 109.46875 C 128.28751 102.66957 130.59475 96.66908 132.59375 91.46875 C 134.59254 86.2687 136.09266 82.15934 137.09375 79.15625 z M 61.1875 272.03125 L 61.1875 311.34375 L 154.46875 311.34375 C 146.66836 320.74333 138.22525 331.37954 129.125 343.28125 C 120.02459 355.18323 111.0794 367.48925 102.28125 380.1875 C 93.482985 392.88595 85.039878 405.46882 76.9375 417.96875 C 68.83506 430.46883 61.971907 441.82625 56.375 452.03125 L 56.375 479.9375 L 219.875 479.9375 L 219.875 440.625 L 113.96875 440.625 C 121.17083 428.6255 129.39262 416.04266 138.59375 402.84375 C 147.7947 389.64498 157.10047 376.83689 166.5 364.4375 C 175.89928 352.03833 184.9829 340.59499 193.78125 330.09375 C 202.57932 319.59281 210.191 311.03557 216.59375 304.4375 L 216.59375 272.03125 L 61.1875 272.03125 z"/>
        </Viewbox>

        <Path x:Key="FilterOnIcon" x:Shared="false" Data="M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3V3H19V3C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z"/>
        <Path x:Key="FilterOffIcon" x:Shared="false" Data="M14.76,20.83L17.6,18L14.76,15.17L16.17,13.76L19,16.57L21.83,13.76L23.24,15.17L20.43,18L23.24,20.83L21.83,22.24L19,19.4L16.17,22.24L14.76,20.83M12,12V19.88C12.04,20.18 11.94,20.5 11.71,20.71C11.32,21.1 10.69,21.1 10.3,20.71L8.29,18.7C8.06,18.47 7.96,18.16 8,17.87V12H7.97L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L12.03,12H12Z"/>
        <Path x:Key="FindIcon" x:Shared="false" Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
        <Path x:Key="PrintIcon" x:Shared="false" Data="M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"/>
        <Path x:Key="CloneIcon" x:Shared="false" Data="M11,17H4A2,2 0 0,1 2,15V3A2,2 0 0,1 4,1H16V3H4V15H11V13L15,16L11,19V17M19,21V7H8V13H6V7A2,2 0 0,1 8,5H19A2,2 0 0,1 21,7V21A2,2 0 0,1 19,23H8A2,2 0 0,1 6,21V19H8V21H19Z"/>
        <Path x:Key="RefreshIcon" x:Shared="false" Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>

        <Path x:Key="ExcelIcon" x:Shared="false" Data="M23.553 3.102h-8.04V4.59h2.37v2.354h-2.37v.75h2.37v2.357h-2.37v.771h2.37v2.229h-2.37v.893h2.37v2.234h-2.37v.893h2.37v2.247h-2.37v1.639h8.04c.127-.038.233-.188.318-.448.085-.262.129-.475.129-.636V3.374c0-.128-.044-.205-.129-.232-.085-.026-.191-.04-.318-.04zM22.51 19.316h-3.857v-2.245h3.857v2.247-.002zm0-3.138h-3.857v-2.235h3.857v2.235zm0-3.128h-3.857v-2.219h3.857v2.221-.002zm0-3h-3.857V7.696h3.857v2.355-.001zm0-3.119h-3.857v-2.34h3.857v2.355-.015zM0 2.731v18.601l14.16 2.449V.219L0 2.739v-.008zm8.393 14.071c-.054-.146-.308-.766-.758-1.863-.449-1.096-.72-1.734-.799-1.916h-.025l-1.519 3.615-2.03-.137 2.408-4.5-2.205-4.5 2.07-.109 1.368 3.521h.027l1.545-3.681 2.139-.135-2.547 4.87 2.625 4.968-2.299-.135v.002z"/>
        <Viewbox x:Key="TextFileIcon" x:Shared="false" Width="24" Height="24">
            <Path Stretch="Uniform" Width="32" Height="32" Data="M21,13 L21,10 L21,10 L15,3 L4.00276013,3 C2.89666625,3 2,3.89833832 2,5.00732994 L2,27.9926701 C2,29.1012878 2.89092539,30 3.99742191,30 L19.0025781,30 C20.1057238,30 21,29.1017876 21,28.0092049 L21,26 L28.9931517,26 C30.6537881,26 32,24.6577357 32,23.0012144 L32,15.9987856 C32,14.3426021 30.6640085,13 28.9931517,13 L21,13 L21,13 L21,13 Z M20,26 L20,28.0066023 C20,28.5550537 19.5523026,29 19.0000398,29 L3.9999602,29 C3.45470893,29 3,28.5543187 3,28.004543 L3,4.99545703 C3,4.45526288 3.44573523,4 3.9955775,4 L14,4 L14,8.99408095 C14,10.1134452 14.8944962,11 15.9979131,11 L20,11 L20,13 L12.0068483,13 C10.3462119,13 9,14.3422643 9,15.9987856 L9,23.0012144 C9,24.6573979 10.3359915,26 12.0068483,26 L20,26 L20,26 L20,26 Z M15,4.5 L15,8.99121523 C15,9.54835167 15.4506511,10 15.9967388,10 L19.6999512,10 L15,4.5 L15,4.5 Z M11.9945615,14 C10.8929956,14 10,14.9001762 10,15.992017 L10,23.007983 C10,24.1081436 10.9023438,25 11.9945615,25 L29.0054385,25 C30.1070044,25 31,24.0998238 31,23.007983 L31,15.992017 C31,14.8918564 30.0976562,14 29.0054385,14 L11.9945615,14 L11.9945615,14 Z M14,17 L14,23 L15,23 L15,17 L17,17 L17,16 L12,16 L12,17 L14,17 L14,17 Z M20,19.5 L18,16 L19,16 L20.5,18.625 L22,16 L23,16 L21,19.5 L23,23 L22,23 L20.5,20.375 L19,23 L18,23 L20,19.5 L20,19.5 Z M26,17 L26,23 L27,23 L27,17 L29,17 L29,16 L24,16 L24,17 L26,17 L26,17 Z"/>
        </Viewbox>

    </UserControl.Resources>

    <Grid Background="{StaticResource Mwi.WindowBar.BackgroundBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <ToolBar Grid.Column="0" x:Name="CommandBar" ToolBarTray.IsLocked="True" ToolBar.OverflowMode="Never" Padding="0" Margin="-3 -2 0 -3">
            <ToolBar.Style>
                <Style TargetType="ToolBar">
                    <Setter Property="Background" Value="Transparent"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DGViewModel}" Value="{x:Null}">
                            <Setter Property="IsEnabled" Value="False"/>
                        </DataTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="LightGray"/>
                            <Setter Property="Opacity" Value="0.15"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ToolBar.Style>

            <Button Content="{StaticResource SettingsIcon}" Padding="0"/>

            <ToggleButton x:Name="OpenSettingButton" Content="{StaticResource OpenIcon}" Padding="0" IsThreeState="False" Checked="OpenSettingButton_OnChecked">
                <ToggleButton.Resources>
                    <ContextMenu x:Key="items" StaysOpen="False" Placement="Bottom" LayoutTransform="{StaticResource ScaleTransform}">
                        <MenuItem Header="Copy"/>
                        <MenuItem Header="Paste"/>
                        <MenuItem Header="Delete"/>
                    </ContextMenu>
                </ToggleButton.Resources>
            </ToggleButton>

            <Button Content="{StaticResource SaveIcon}"/>

            <Separator Margin="3"/>
            <ToggleButton x:Name="ToggleGridVisibilityButton" Foreground="{DynamicResource Mwi.WindowBar.ForegroundBrush}"
                                       Margin="0 0 2 0" Width="26" Height="26" Padding="2"
                                       Style="{StaticResource {x:Static ToolBar.ToggleButtonStyleKey}}"
                                       Focusable="False" IsThreeState="False"
                                       IsChecked="{Binding DGControl.GridLinesVisibility, Converter={x:Static common:GridLinesVisibilityConverter.Instance}, Mode=TwoWay}"
                                       ToolTip="Show/Hide grid lines"
                                       controls:DualPathToggleButtonEffect.GeometryOff="{StaticResource GridOffGeometry}"
                                       controls:DualPathToggleButtonEffect.GeometryOn="{StaticResource GridOnGeometry}"/>

            <Button Content="{StaticResource FontIcon}" Margin="0"/>
            <Separator Margin="3"/>
            <ComboBox Name="CellViewModeComboBox" DisplayMemberPath="Name" Focusable="False" SelectionChanged="Do_CellViewMode"/>

            <Separator Margin="3"/>
            <ToggleButton x:Name="GroupLayerButton" Content="{StaticResource GroupLayerIcon}" Padding="0" IsThreeState="False" Checked="OpenSettingButton_OnChecked">
                <ToggleButton.Resources>
                    <ContextMenu x:Key="items" StaysOpen="False" Placement="Bottom" LayoutTransform="{StaticResource ScaleTransform}">
                        <MenuItem Header="Copy"/>
                        <MenuItem Header="Paste"/>
                        <MenuItem Header="Delete"/>
                    </ContextMenu>
                </ToggleButton.Resources>
            </ToggleButton>

            <Separator Margin="3"/>
            <Button Content="{StaticResource SortAscendingIcon}"/>
            <Button Content="{StaticResource SortDescendingIcon}"/>
            <Button Content="{StaticResource SortOffIcon}"/>

            <Separator Margin="3"/>
            <Button Content="{StaticResource FilterOnIcon}"/>
            <Button Content="{StaticResource FilterOffIcon}"/>
            <TextBox Name="FastFilterTxt" Width="100" TextChanged="Do_FastFilter"/>
            <Button Content="{StaticResource FindIcon}"/>

            <Separator Margin="3"/>
            <Button Content="{StaticResource PrintIcon}"/>

            <Separator Margin="3"/>
            <Button Content="{StaticResource CloneIcon}"/>
            <Button Content="{StaticResource RefreshIcon}"/>

            <Separator Margin="3"/>
            <Button Content="{StaticResource ExcelIcon}"/>
            <Button Content="{StaticResource TextFileIcon}"/>
            <Separator/>
        </ToolBar>
    </Grid>
</UserControl>
