<Window x:Class="DGView.Temp.PrintPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:common="clr-namespace:WpfSpLib.Common;assembly=WpfSpLib"
        xmlns:effects="clr-namespace:WpfSpLib.Effects;assembly=WpfSpLib"
        xmlns:temp="clr-namespace:DGView.Temp"
        xmlns:helpers="clr-namespace:DGView.Helpers"
        mc:Ignorable="d"
        Title="Print Preview" Height="800" Width="1100"
        FontSize="14"
        Topmost="False" ShowInTaskbar="False" WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <Geometry x:Key="PrintGeometry">M0 0Z M32 32Z M26,27 L28.0057181,27 C29.6594143,27 31,25.6556493 31,24.0005775 L31,14.9994225 C31,13.3428872 29.6594313,12 28.0057181,12 L26,12 L26,4.99961498 C26,3.89525812 25.1090746,3 24.0025781,3 L8.99742191,3 C7.89427625,3 7,3.88743329 7,4.99961498 L7,12 L7,12 L4.99428189,12 C3.34058566,12 2,13.3443507 2,14.9994225 L2,24.0005775 C2,25.6571128 3.3405687,27 4.99428189,27 L7,27 L7,28.000385 C7,29.1047419 7.89092539,30 8.99742191,30 L24.0025781,30 C25.1057238,30 26,29.1125667 26,28.000385 L26,27 L26,27 L26,27 Z M7,26 L5.00732994,26 C3.89833832,26 3,25.1033337 3,23.9972399 L3,15.0027601 C3,13.8935426 3.89871223,13 5.00732994,13 L27.9926701,13 C29.1016617,13 30,13.8966663 30,15.0027601 L30,23.9972399 C30,25.1064574 29.1012878,26 27.9926701,26 L26,26 L26,20 L7,20 L7,26 L7,26 L7,26 Z M8.9999602,4 C8.44769743,4 8,4.45303631 8,4.99703014 L8,12 L25,12 L25,4.99703014 C25,4.4463856 24.5452911,4 24.0000398,4 L8.9999602,4 L8.9999602,4 Z M8,21 L8,28.0029699 C8,28.5536144 8.45470893,29 8.9999602,29 L24.0000398,29 C24.5523026,29 25,28.5469637 25,28.0029699 L25,21 L8,21 L8,21 Z M25,17 C25.5522848,17 26,16.5522848 26,16 C26,15.4477152 25.5522848,15 25,15 C24.4477152,15 24,15.4477152 24,16 C24,16.5522848 24.4477152,17 25,17 L25,17 Z M9,23 L9,24 L24,24 L24,23 L9,23 L9,23 Z M9,26 L9,27 L24,27 L24,26 L9,26 L9,26 Z</Geometry>
        <Geometry x:Key="PDFGeometry">M0 0 Z M16 16Z M 2.238281 0.640625 L 2.238281 15.359375 L 13.761719 15.359375 L 13.761719 4.671875 L 13.671875 4.570312 L 9.828125 0.730469 L 9.730469 0.640625 Z M 2.878906 1.28125 L 9.28125 1.28125 L 9.28125 5.121094 L 13.121094 5.121094 L 13.121094 14.71875 L 2.878906 14.71875 Z M 9.921875 1.738281 L 12.660156 4.480469 L 9.921875 4.480469 Z M4.603 14.087a.81.81 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.68 7.68 0 0 1 1.482-.645 19.697 19.697 0 0 0 1.062-2.227 7.269 7.269 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a10.954 10.954 0 0 0 .98 1.686 5.753 5.753 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.856.856 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.712 5.712 0 0 1-.911-.95 11.651 11.651 0 0 0-1.997.406 11.307 11.307 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.793.793 0 0 1-.58.029zm1.379-1.901c-.166.076-.32.156-.459.238-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361.01.022.02.036.026.044a.266.266 0 0 0 .035-.012c.137-.056.355-.235.635-.572a8.18 8.18 0 0 0 .45-.606zm1.64-1.33a12.71 12.71 0 0 1 1.01-.193 11.744 11.744 0 0 1-.51-.858 20.801 20.801 0 0 1-.5 1.05zm2.446.45c.15.163.296.3.435.41.24.19.407.253.498.256a.107.107 0 0 0 .07-.015.307.307 0 0 0 .094-.125.436.436 0 0 0 .059-.2.095.095 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a3.876 3.876 0 0 0-.612-.053zM8.078 7.8a6.7 6.7 0 0 0 .2-.828c.031-.188.043-.343.038-.465a.613.613 0 0 0-.032-.198.517.517 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822.024.111.054.227.09.346z</Geometry>
        <Geometry x:Key="XPSGeometry">M0 0 Z M16 16Z M 2.238281 0.640625 L 2.238281 15.359375 L 13.761719 15.359375 L 13.761719 4.671875 L 13.671875 4.570312 L 9.828125 0.730469 L 9.730469 0.640625 Z M 2.878906 1.28125 L 9.28125 1.28125 L 9.28125 5.121094 L 13.121094 5.121094 L 13.121094 14.71875 L 2.878906 14.71875 Z M 9.921875 1.738281 L 12.660156 4.480469 L 9.921875 4.480469 Z M 4.160156 8.136719 L 4.84375 9.390625 L 5.523438 8.136719 L 6.386719 8.136719 L 5.328125 9.9375 L 6.414062 11.773438 L 5.542969 11.773438 L 4.84375 10.496094 L 4.140625 11.773438 L 3.269531 11.773438 L 4.355469 9.9375 L 3.296875 8.136719 Z M 8.195312 10.488281 L 7.539062 10.488281 L 7.539062 11.773438 L 6.789062 11.773438 L 6.789062 8.136719 L 8.210938 8.136719 C 8.484375 8.136719 8.722656 8.183594 8.929688 8.285156 C 9.136719 8.382812 9.296875 8.527344 9.410156 8.710938 C 9.519531 8.894531 9.574219 9.105469 9.574219 9.339844 C 9.574219 9.695312 9.453125 9.976562 9.210938 10.183594 C 8.964844 10.386719 8.628906 10.488281 8.195312 10.488281 Z M 7.539062 8.742188 L 7.539062 9.882812 L 8.210938 9.882812 C 8.40625 9.882812 8.558594 9.835938 8.664062 9.742188 C 8.765625 9.648438 8.820312 9.515625 8.820312 9.34375 C 8.820312 9.164062 8.765625 9.019531 8.660156 8.910156 C 8.554688 8.800781 8.410156 8.746094 8.226562 8.742188 Z M 11.976562 10.816406 C 11.976562 10.675781 11.925781 10.566406 11.828125 10.492188 C 11.726562 10.414062 11.546875 10.335938 11.289062 10.253906 C 11.027344 10.167969 10.820312 10.085938 10.671875 10.003906 C 10.257812 9.78125 10.050781 9.480469 10.050781 9.101562 C 10.050781 8.90625 10.105469 8.730469 10.214844 8.574219 C 10.328125 8.421875 10.488281 8.300781 10.695312 8.214844 C 10.902344 8.128906 11.132812 8.085938 11.390625 8.085938 C 11.652344 8.085938 11.882812 8.132812 12.085938 8.226562 C 12.289062 8.320312 12.449219 8.453125 12.558594 8.625 C 12.671875 8.796875 12.730469 8.992188 12.730469 9.210938 L 11.980469 9.210938 C 11.980469 9.042969 11.925781 8.914062 11.824219 8.820312 C 11.71875 8.726562 11.570312 8.683594 11.378906 8.683594 C 11.195312 8.683594 11.054688 8.71875 10.953125 8.796875 C 10.851562 8.875 10.800781 8.976562 10.800781 9.105469 C 10.800781 9.222656 10.859375 9.320312 10.980469 9.402344 C 11.097656 9.480469 11.273438 9.554688 11.503906 9.625 C 11.929688 9.753906 12.242188 9.914062 12.4375 10.101562 C 12.632812 10.292969 12.730469 10.53125 12.730469 10.8125 C 12.730469 11.128906 12.609375 11.375 12.371094 11.554688 C 12.132812 11.734375 11.8125 11.824219 11.410156 11.824219 C 11.128906 11.824219 10.875 11.769531 10.644531 11.667969 C 10.414062 11.566406 10.242188 11.425781 10.121094 11.246094 C 10 11.070312 9.9375 10.863281 9.9375 10.628906 L 10.691406 10.628906 C 10.691406 11.027344 10.929688 11.230469 11.410156 11.230469 C 11.589844 11.230469 11.726562 11.195312 11.828125 11.121094 C 11.925781 11.050781 11.976562 10.949219 11.976562 10.816406 Z</Geometry>
        <Geometry x:Key="PrinterGeometry">M0 0Z M128 128Z M18.46,89.86H7.82A7.8,7.8,0,0,1,2.3,87.57l-.24-.26A7.82,7.82,0,0,1,0,82V35.44a7.81,7.81,0,0,1,2.3-5.53l.25-.23a7.77,7.77,0,0,1,5.27-2.06H20.13A8.07,8.07,0,0,1,20,26.14v-18a8.05,8.05,0,0,1,2.39-5.72h0A8.07,8.07,0,0,1,28.1,0H94.78a8.13,8.13,0,0,1,8.11,8.11v18a8.07,8.07,0,0,1-.14,1.48h12.31a7.81,7.81,0,0,1,5.51,2.29h0a7.8,7.8,0,0,1,2.3,5.52V82a7.84,7.84,0,0,1-7.82,7.82H104.42v20.31a4.63,4.63,0,0,1-1.36,3.28,4.32,4.32,0,0,1-.39.34,4.6,4.6,0,0,1-2.89,1H23.1a4.63,4.63,0,0,1-3.28-1.36,3.06,3.06,0,0,1-.34-.39,4.6,4.6,0,0,1-1-2.89V89.86ZM27,27.62H95.91l.19-.17a1.86,1.86,0,0,0,.55-1.31v-18a1.88,1.88,0,0,0-1.87-1.87H28.1a1.87,1.87,0,0,0-1.32.55h0a1.87,1.87,0,0,0-.54,1.32v18a1.84,1.84,0,0,0,.55,1.31l.19.17Zm9.3,71.71a2.4,2.4,0,0,1,0-4.8H63.64a2.4,2.4,0,0,1,0,4.8Zm0-14.56a2.4,2.4,0,0,1,0-4.8H86.61a2.4,2.4,0,0,1,0,4.8ZM7.07,60.61H115.81V35.44a.76.76,0,0,0-.22-.54.77.77,0,0,0-.53-.22H7.82a.76.76,0,0,0-.46.16l-.07.07a.76.76,0,0,0-.22.53V60.61Zm108.74,7.07H102.19a4.13,4.13,0,0,1,.87.69,4.63,4.63,0,0,1,1.36,3.28V82.79h10.64a.75.75,0,0,0,.53-.22.79.79,0,0,0,.22-.53V67.68Zm-95.12,0H7.07V82a.81.81,0,0,0,.15.46l.07.07a.75.75,0,0,0,.53.22H18.46V71.65a4.63,4.63,0,0,1,1.36-3.28,4.13,4.13,0,0,1,.87-.69Zm76.67,4.23H25.52v35.83H97.36V71.91Z</Geometry>
        <Geometry x:Key="FaxGeometry">M0 0Z M128 128Z M27.953,5.569v96.769h19.792V5.569H37.456H27.953L27.953,5.569z M21.898,105.123V2.785C21.898,1.247,23.254,0,24.926,0 h12.53h13.316C52.443,0,53.8,1.247,53.8,2.785v102.338c0,1.537-1.356,2.783-3.028,2.783H24.926 C23.254,107.906,21.898,106.66,21.898,105.123L21.898,105.123z M13.32,17.704c1.671,0,3.027,1.247,3.027,2.785 s-1.355,2.784-3.027,2.784H7.352c-0.161,0-0.292,0.022-0.39,0.064c-0.129,0.056-0.276,0.166-0.429,0.325 c-0.161,0.167-0.281,0.346-0.353,0.528c-0.083,0.208-0.125,0.465-0.125,0.759v90.803c0,0.287,0.043,0.537,0.125,0.74l0.034,0.092 c0.068,0.135,0.165,0.264,0.284,0.383c0.126,0.125,0.258,0.217,0.39,0.27c0.123,0.051,0.279,0.074,0.466,0.074h97.052 c0.188,0,0.346-0.025,0.467-0.074c0.133-0.053,0.264-0.145,0.389-0.27c3.035-3.035,0.441,1.799,0.441-1.215V24.949 c0-3.667,3.039,2.357-0.477-1.288c-0.143-0.146-0.287-0.254-0.43-0.314c-0.113-0.048-0.246-0.075-0.391-0.075H62.563 c-1.672,0-3.027-1.247-3.027-2.784s1.355-2.785,3.027-2.785h41.842c1.041,0,2.029,0.204,2.943,0.597 c0.895,0.385,1.699,0.945,2.393,1.663c0.664,0.686,1.17,1.468,1.514,2.334c0.332,0.839,0.502,1.726,0.502,2.652v90.803 c0,0.938-0.168,1.826-0.502,2.654c-0.344,0.859-0.865,1.639-1.549,2.324c-0.701,0.703-1.506,1.234-2.398,1.598 c-0.906,0.367-1.879,0.551-2.902,0.551H7.352c-1.022,0-1.995-0.184-2.901-0.551c-0.894-0.363-1.698-0.896-2.399-1.598 c-0.621-0.623-1.107-1.33-1.45-2.107c-0.036-0.07-0.069-0.143-0.099-0.217C0.168,117.574,0,116.684,0,115.752V24.949 c0-0.921,0.17-1.811,0.504-2.652c0.342-0.863,0.849-1.648,1.512-2.334c0.683-0.707,1.488-1.263,2.393-1.652 c0.929-0.401,1.917-0.607,2.943-0.607H13.32L13.32,17.704z M65.902,29.03h27.049c0.803,0,1.566,0.145,2.291,0.431 c0.076,0.03,0.15,0.063,0.223,0.099c0.607,0.269,1.166,0.635,1.666,1.096c0.584,0.533,1.027,1.128,1.326,1.782 c0.047,0.104,0.088,0.21,0.119,0.317c0.225,0.584,0.34,1.189,0.34,1.812v12.611c0,0.744-0.156,1.45-0.459,2.118l-0.004,0.009 l0.004,0.002c-0.291,0.64-0.725,1.224-1.291,1.75c-0.58,0.546-1.227,0.956-1.932,1.231c-0.736,0.287-1.5,0.426-2.283,0.426H65.902 c-0.777,0-1.535-0.14-2.27-0.426c-0.693-0.269-1.33-0.668-1.912-1.198c-0.588-0.539-1.031-1.144-1.326-1.81 c-0.033-0.078-0.063-0.157-0.09-0.235c-0.234-0.605-0.35-1.228-0.35-1.867V34.567c0-0.723,0.146-1.424,0.445-2.099l-0.006-0.002 c0.295-0.666,0.738-1.271,1.326-1.81l0.037-0.032l-0.002-0.001c0.877-0.78,2.039-1.219,2.119-1.244 C64.537,29.147,65.215,29.03,65.902,29.03L65.902,29.03z M93.475,34.599h-28.08v12.547h28.08V34.599L93.475,34.599z M78.877,63.42 c1.072,0,2.01,0.41,2.807,1.207s1.188,1.734,1.188,2.785c0,1.148-0.389,2.104-1.188,2.865c-0.799,0.758-1.734,1.129-2.807,1.129 c-1.129,0-2.084-0.371-2.844-1.129c-0.76-0.762-1.148-1.717-1.148-2.865c0-1.051,0.391-1.988,1.148-2.785 S77.748,63.42,78.877,63.42L78.877,63.42z M90.977,63.42c1.072,0,2.008,0.41,2.805,1.207s1.189,1.734,1.189,2.785 c0,1.148-0.391,2.104-1.189,2.865c-0.799,0.758-1.732,1.129-2.805,1.129c-1.131,0-2.086-0.371-2.846-1.129 c-0.76-0.762-1.148-1.717-1.148-2.865c0-1.051,0.391-1.988,1.148-2.785S89.846,63.42,90.977,63.42L90.977,63.42z M66.662,75.518 c1.15,0,2.105,0.389,2.865,1.148s1.129,1.715,1.129,2.865c0,1.051-0.371,1.988-1.129,2.785s-1.715,1.209-2.865,1.209 c-1.053,0-1.988-0.412-2.785-1.209s-1.209-1.734-1.209-2.785c0-1.15,0.41-2.105,1.209-2.865S65.609,75.518,66.662,75.518 L66.662,75.518z M78.877,75.518c1.072,0,2.008,0.389,2.807,1.148s1.188,1.715,1.188,2.865c0,1.051-0.391,1.988-1.188,2.785 s-1.734,1.209-2.807,1.209c-1.129,0-2.086-0.412-2.844-1.209s-1.148-1.734-1.148-2.785c0-1.15,0.389-2.105,1.148-2.865 S77.748,75.518,78.877,75.518L78.877,75.518z M90.977,75.518c1.072,0,2.006,0.389,2.805,1.148s1.189,1.715,1.189,2.865 c0,1.051-0.393,1.988-1.189,2.785s-1.732,1.209-2.805,1.209c-1.131,0-2.088-0.412-2.846-1.209s-1.148-1.734-1.148-2.785 c0-1.15,0.389-2.105,1.148-2.865S89.846,75.518,90.977,75.518L90.977,75.518z M66.662,87.518c1.15,0,2.107,0.393,2.865,1.189 s1.129,1.773,1.129,2.922c0,1.053-0.369,1.988-1.129,2.787s-1.715,1.207-2.865,1.207c-1.053,0-1.986-0.408-2.785-1.207 s-1.209-1.734-1.209-2.787c0-1.148,0.412-2.125,1.209-2.922S65.609,87.518,66.662,87.518L66.662,87.518z M78.877,87.518 c1.072,0,2.01,0.393,2.807,1.189s1.188,1.773,1.188,2.922c0,1.053-0.389,1.988-1.188,2.787s-1.734,1.207-2.807,1.207 c-1.129,0-2.084-0.408-2.844-1.207s-1.148-1.734-1.148-2.787c0-1.148,0.391-2.125,1.148-2.922S77.748,87.518,78.877,87.518 L78.877,87.518z M90.977,87.518c1.072,0,2.008,0.393,2.805,1.189s1.189,1.773,1.189,2.922c0,1.053-0.391,1.988-1.189,2.787 s-1.732,1.207-2.805,1.207c-1.131,0-2.086-0.408-2.846-1.207s-1.148-1.734-1.148-2.787c0-1.148,0.391-2.125,1.148-2.922 S89.846,87.518,90.977,87.518L90.977,87.518z M78.877,99.617c1.072,0,2.008,0.389,2.807,1.188s1.188,1.734,1.188,2.807 c0,1.129-0.389,2.084-1.188,2.844s-1.734,1.148-2.807,1.148c-1.129,0-2.084-0.389-2.844-1.148s-1.148-1.715-1.148-2.844 c0-1.072,0.389-2.008,1.148-2.807S77.748,99.617,78.877,99.617L78.877,99.617z M66.662,63.42c1.15,0,2.107,0.41,2.865,1.207 s1.129,1.734,1.129,2.785c0,1.148-0.369,2.104-1.129,2.865c-0.76,0.758-1.715,1.129-2.865,1.129c-1.053,0-1.986-0.371-2.785-1.129 c-0.799-0.762-1.209-1.717-1.209-2.865c0-1.051,0.412-1.988,1.209-2.785S65.609,63.42,66.662,63.42L66.662,63.42z</Geometry>

        <DropShadowEffect x:Key="ShadowEffect" BlurRadius="5" ShadowDepth="2" Direction="315"/>

        <Style x:Key="SeparatorStyle" TargetType="Grid">
            <Setter Property="Width" Value="1"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="Background" Value="Silver"/>
            <Setter Property="Margin" Value="2 5"/>
        </Style>

        <Style x:Key="ButtonStyle" TargetType="ButtonBase">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="6 0"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ButtonBase">
                        <Border Margin="0" Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}"
                                BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}"
                                CornerRadius="3"
                                SnapsToDevicePixels="True" UseLayoutRounding="True">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Content="{TemplateBinding Content}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E4E4E4"/>
                                <Setter Property="Foreground" Value="DimGray"/>
                                <Setter Property="BorderBrush" Value="LightGray"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#EAEAEA"/>
                                <Setter Property="Foreground" Value="DimGray"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Resources>
                <Style TargetType="Path">
                    <Setter Property="Stretch" Value="Fill"/>
                    <Setter Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type Control}}, Path=Foreground}"/>
                </Style>
            </Style.Resources>
        </Style>

        <Style x:Key="IconButtonStyle" TargetType="Button" BasedOn="{StaticResource ButtonStyle}" x:Shared="False">
            <Setter Property="Content">
                <Setter.Value>
                    <Viewbox Width="20" Height="20">
                        <Path Data="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Tag}"/>
                    </Viewbox>
                </Setter.Value>
            </Setter>
        </Style>

        <Geometry x:Key="CloseGeometry">M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z</Geometry>
        <Geometry x:Key="DownArrowGeometry">M0 0 L1 1 L2 0 Z</Geometry>
        <Style x:Key="PrinterSelectorStyle" TargetType="ToggleButton" BasedOn="{StaticResource ButtonStyle}">
            <Setter Property="IsThreeState" Value="False"/>
            <Setter Property="effects:DoubleIconToggleButtonEffect.GeometryOff" Value="{StaticResource DownArrowGeometry}"/>
            <Setter Property="effects:DoubleIconToggleButtonEffect.GeometryOn" Value="{StaticResource CloseGeometry}"/>
            <Setter Property="effects:DoubleIconToggleButtonEffect.Width" Value="9"/>
            <Setter Property="effects:DoubleIconToggleButtonEffect.MarginOff" Value="3 0"/>
            <Setter Property="effects:DoubleIconToggleButtonEffect.MarginOn" Value="3 0"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Vertical" Margin="10" Background="Yellow">
            <Button Content="Add data" Click="OnAddDataClick" Margin="5 0"/>
            <Button Content="Clear" Click="OnClearClick" Margin="5 0"/>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="PageCount: " Margin="5 0"/>
                <TextBlock x:Name="Pages1" Text="{Binding ElementName=DocumentViewer, Path=PageCount}" Margin="5 0"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Saved pages: " Margin="5 0"/>
                <TextBlock x:Name="txtSavedPages" Text="{Binding Path=SavedPages}" Margin="5 0"/>
            </StackPanel>
            <Button Content="Save to a191.xps" ToolTip="Print" Click="OnSaveToXpsClick" Width="100" Margin="5 0"/>
            <Button Content="Print dialog" ToolTip="Print" Click="OnPrintDialogClick" Width="100" Margin="5 0"/>
            <RadioButton IsChecked="{Binding Path=(temp:PrintPreviewViewModel.CurrentMeasurementSystem), Converter={x:Static helpers:ComparisonConverter.Instance}, ConverterParameter={x:Static temp:PrintPreviewViewModel+MeasurementSystem.Metric}}">
                Metric
            </RadioButton>
            <RadioButton IsChecked="{Binding Path=(temp:PrintPreviewViewModel.CurrentMeasurementSystem), Converter={x:Static helpers:ComparisonConverter.Instance}, ConverterParameter={x:Static temp:PrintPreviewViewModel+MeasurementSystem.US}}">
                U.S.
            </RadioButton>
        </StackPanel>

        <DocumentViewer Grid.Column="1" x:Name="DocumentViewer" ShowPageBorders="True" BorderBrush="LightGray" BorderThickness="0">
            <DocumentViewer.Template>
                <ControlTemplate TargetType="DocumentViewer">
                    <Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <WrapPanel Grid.Row="0" x:Name="TopPanel" Background="Gainsboro" Orientation="Horizontal" Margin="0"
                                       SizeChanged="OnTopPanelSizeChanged">

                                <Button Margin="0" Style="{StaticResource ButtonStyle}" ToolTip="Print" FontSize="16">
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Stretch" Margin="4 0">
                                        <Viewbox Width="24" Height="24">
<!--                                            <Path Data="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>-->
                                            <Path Data="{StaticResource PrintGeometry}"/>
                                        </Viewbox>
                                        <TextBlock Text="Print" Margin="6 0 0 0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Button>

                                <Grid Style="{StaticResource SeparatorStyle}"/>

                                <ToggleButton x:Name="PrintSelector" Padding="4 0" Width="200" HorizontalContentAlignment="Left"
                                              ToolTip="Select printing device" Content="{Binding CurrentPrinter.PrintQueue.FullName}"
                                              Style="{StaticResource PrinterSelectorStyle}" >
                                    <!--<ToggleButton.Content>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding CurrentPrinter.Icon}" Height="24" Width="24"/>
                                            <TextBlock Margin="4 0 0 0" VerticalAlignment="Center" Text="{Binding CurrentPrinter.PrintQueue.FullName}"/>
                                        </StackPanel>
                                    </ToggleButton.Content>-->
                                    <ToggleButton.Resources>
                                        <!--<Image x:Key="PrintIcon" x:Shared="False" Source="{Binding Path=Icon}" Height="24" Width="24"/>-->
                                        <Viewbox x:Key="PrintIcon" x:Shared="False" Height="20" Width="20">
                                            <Path Fill="DarkSlateGray" Stretch="Fill" Data="{Binding Icon}"/>
                                        </Viewbox>
                                        <ContextMenu x:Key="cm" StaysOpen="False" Focusable="False" Effect="{StaticResource ShadowEffect}" ItemsSource="{Binding Printers}">
                                            <ContextMenu.Resources>
                                                <Style TargetType="MenuItem">
                                                    <Setter Property="FontSize" Value="14"/>
                                                    <Setter Property="Foreground" Value="DarkSlateGray"/>
                                                    <Setter Property="Header" Value="{Binding PrintQueue.FullName}"/>
                                                    <Setter Property="Icon" Value="{StaticResource PrintIcon}"/>
                                                    <Setter Property="Command" Value="{Binding PrinterSelectCommand}"/>
                                                </Style>
                                            </ContextMenu.Resources>
                                        </ContextMenu>
                                    </ToggleButton.Resources>
                                </ToggleButton>

                                <Button Margin="5 0 0 0" Style="{StaticResource IconButtonStyle}" ToolTip="Page Setup"
                                        Tag="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>

                                <Grid Style="{StaticResource SeparatorStyle}"/>

                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Zoom In"
                                        Command="NavigationCommands.IncreaseZoom"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0Z M16 16Z M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>

                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Zoom In"
                                        Command="NavigationCommands.IncreaseZoom"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0 Z M16 16Z M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z M3 6.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>

                                <Grid Style="{StaticResource SeparatorStyle}"/>

                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Actual Size"
                                        Command="NavigationCommands.Zoom" CommandParameter="100.0"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0 Z M912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112zM368.896 704a32 32 0 0 1-32-32v-105.888H224a32 32 0 0 1 0-64h144.896a32 32 0 0 1 32 32V672a32 32 0 0 1-32 32zM784.864 566.112H672V672a32 32 0 1 1-64 0v-137.888a32 32 0 0 1 32-32h144.864a32 32 0 1 1 0 64zM368.896 256H224a32 32 0 1 1 0-64h112.896v-105.92a32 32 0 1 1 64 0V224a32 32 0 0 1-32 32zM784.864 256H640a32 32 0 0 1-32-32v-137.92a32 32 0 1 1 64 0V192h112.864a32 32 0 1 1 0 64z"/>

                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Fit To Width"
                                        Command="DocumentViewer.FitToWidthCommand"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0Z M368.896 704H224a32 32 0 0 1-32-32v-137.888a32 32 0 0 1 64 0V640h112.896a32 32 0 0 1 0 64zM784.864 704H640a32 32 0 1 1 0-64h112.864v-105.888a32 32 0 1 1 64 0V672a32 32 0 0 1-32 32zM368.896 118.08H256V224a32 32 0 1 1-64 0v-137.92a32 32 0 0 1 32-32h144.896a32 32 0 1 1 0 64zM784.864 256a32 32 0 0 1-32-32v-105.92H640a32 32 0 1 1 0-64h144.864a32 32 0 0 1 32 32V224a32 32 0 0 1-32 32zM912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112z"/>
                                <!-- One -->
                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Whole Page"
                                        Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandParameter="1"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0Z M 565.757812 127.601562 L 565.757812 646.539062 L 499.746094 646.539062 L 499.746094 209.203125 L 367.449219 257.773438 L 367.449219 198.226562 L 555.472656 127.601562 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z"/>
                                <!-- Two -->
                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Two Pages"
                                        Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandParameter="2"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0Z M 699.085938 595.292969 L 699.085938 648.84375 L 360.691406 648.84375 L 360.691406 601.65625 L 539.484375 403.03125 C 565.960938 373.019531 584.21875 348.609375 594.257812 329.804688 C 604.332031 311 609.371094 291.539062 609.371094 271.425781 C 609.371094 244.488281 601.203125 222.378906 584.871094 205.09375 C 568.578125 187.84375 546.820312 179.21875 519.601562 179.21875 C 486.972656 179.21875 461.613281 188.496094 443.511719 207.054688 C 425.449219 225.613281 416.417969 251.453125 416.417969 284.574219 L 350.773438 284.574219 C 350.773438 237.03125 366.082031 198.609375 396.695312 169.304688 C 427.339844 139.964844 468.308594 125.292969 519.601562 125.292969 C 567.605469 125.292969 605.570312 137.894531 633.496094 163.097656 C 661.386719 188.269531 675.332031 221.777344 675.332031 263.632812 C 675.332031 314.464844 642.933594 375 578.140625 445.234375 L 439.800781 595.292969 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z"/>
                                <!-- Four -->
                                <Button Style="{StaticResource IconButtonStyle}" ToolTip="Four Pages"
                                        Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandParameter="4"
                                        CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                        Tag="M0 0Z M 613.160156 123.542969 L 613.160156 466.550781 L 684.796875 466.550781 L 684.796875 520.105469 L 613.160156 520.105469 L 613.160156 639.992188 L 547.199219 639.992188 L 547.199219 520.105469 L 312.042969 520.105469 L 312.042969 481.449219 L 543.277344 123.542969 Z M 539.351562 227.46875 L 386.488281 466.550781 L 547.199219 466.550781 L 547.199219 213.3125 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z"/>

                                <Grid Style="{StaticResource SeparatorStyle}"/>

                                <StackPanel x:Name="Right" Orientation="Horizontal">
                                    <TextBlock Margin="0 0 4 0" VerticalAlignment="Center" Foreground="DimGray"
                                               Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=PageCount, Converter={x:Static common:VisibilityConverter.Instance}}">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}Page {0} / {1}">
                                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="MasterPageNumber" />
                                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="PageCount" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </StackPanel>
                            </WrapPanel>

                            <ScrollViewer x:Name="PART_ContentHost" Grid.Row="1" Cursor="Arrow" CanContentScroll="True"
                                          HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                                          IsTabStop="True" Background="#FFE8E8E8" PanningMode="VerticalOnly"
                                          ManipulationBoundaryFeedback="DocumentPreviewer_ManipulationBoundaryFeedback"/>

                        </Grid>
                    </Border>
                </ControlTemplate>
            </DocumentViewer.Template>
            <DocumentViewer.InputBindings>
                <KeyBinding Key="P" Modifiers="Control" Command="ApplicationCommands.NotACommand" />
            </DocumentViewer.InputBindings>
        </DocumentViewer>
    </Grid>
</Window>
