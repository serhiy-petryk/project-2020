<UserControl x:Class="DGView.Temp.PrintPreviewControl"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DGView.Temp"
        mc:Ignorable="d"
        Height="500" Width="700">
    <UserControl.Resources>
        <SolidColorBrush x:Key="CustomBlue" Color="#FFA0C2F9"></SolidColorBrush>
        <SolidColorBrush x:Key="CustomLightBlue" Color="#FFC9DCFC"></SolidColorBrush>
        <SolidColorBrush x:Key="CustomDarkBlue" Color="#FF4285F4"></SolidColorBrush>
        <SolidColorBrush x:Key="CustomGray" Color="#FFDEDEDE"></SolidColorBrush>

        <Style TargetType="ComboBox" x:Key="AA">
            <Setter Property="Height" Value="34"></Setter>
            <Setter Property="VerticalContentAlignment" Value="Center"></Setter>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Height" Value="34"></Setter>
                        <Setter Property="MinWidth" Value="60"></Setter>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ComboBoxItem">
                                    <Border Name="Back" Height="{TemplateBinding Height}" Background="Transparent"  BorderThickness="0" BorderBrush="#FF459241" >
                                        <ContentPresenter ContentSource="{Binding Source}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5,0,10,0"></ContentPresenter>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Back" Property="Background" Value="{StaticResource CustomLightBlue}"></Setter>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Back" Property="Background" Value="{StaticResource CustomDarkBlue}"></Setter>
                                            <Setter Property="Foreground" Value="White"></Setter>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Border Name="Border" Background="White" BorderThickness="1" BorderBrush="{StaticResource CustomLightBlue}" RenderOptions.EdgeMode="Aliased" SnapsToDevicePixels="True"></Border>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition x:Name="IconColumn" Width="34"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Image Width="25" Height="25" Grid.Column="0" Stretch="Fill" Source="{TemplateBinding Tag}"></Image>
                                <TextBlock Name="ContentTextBlock" Grid.Column="1" Margin="0,0,34,0" VerticalAlignment="Center" Text="{TemplateBinding Text}" TextTrimming="CharacterEllipsis"></TextBlock>
                            </Grid>
                            <ToggleButton Foreground="{Binding ElementName=Border, Path=BorderBrush, Mode=OneWay}" IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press">
                                <ToggleButton.Style>
                                    <Style TargetType="ToggleButton">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Grid Background="Transparent" HorizontalAlignment="Stretch">
                                                        <Grid Height="34" Width="34" HorizontalAlignment="Right">
                                                            <Path x:Name="ToggleBtn1" Visibility="Collapsed" Fill="{TemplateBinding Foreground}" Width="8" Height="6" StrokeThickness="0" Data="M5,0 L10,10 L0,10 z" RenderTransformOrigin="0.5,0.5" Stretch="Fill"></Path>
                                                            <Path x:Name="ToggleBtn2" Visibility="Visible" Fill="{TemplateBinding Foreground}" Width="8" Height="6" StrokeThickness="0" Data="M5,0 L10,10 L0,10 z" RenderTransformOrigin="0.5,0.5" Stretch="Fill">
                                                                <Path.RenderTransform>
                                                                    <RotateTransform Angle="-180"/>
                                                                </Path.RenderTransform>
                                                            </Path>
                                                        </Grid>
                                                    </Grid>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="ToggleBtn1" Property="Visibility" Value="Visible"></Setter>
                                                            <Setter TargetName="ToggleBtn2" Property="Visibility" Value="Collapsed"></Setter>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ToggleButton.Style>
                            </ToggleButton>
                            <Popup IsOpen="{TemplateBinding IsDropDownOpen}" Placement="Bottom" x:Name="Popup" AllowsTransparency="True" PopupAnimation="Slide">
                                <Border BorderThickness="1" BorderBrush="{StaticResource CustomBlue}" MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{TemplateBinding ActualWidth}" x:Name="DropDown" Background="White">
                                    <ScrollViewer MaxHeight="{TemplateBinding MaxDropDownHeight}" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" CanContentScroll="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Tag" Value="{x:Null}">
                                <Setter TargetName="IconColumn" Property="Width" Value="0"></Setter>
                                <Setter TargetName="ContentTextBlock" Property="Margin" Value="5,0,34,0"/>
                            </Trigger>
                            <Trigger Property="SelectedIndex" Value="-1">
                                <Setter TargetName="ContentTextBlock" Property="Text" Value="- Please Select -"/>
                            </Trigger>
                            <Trigger Property="SelectedItem" Value="{x:Null}">
                                <Setter TargetName="ContentTextBlock" Property="Text" Value="- Please Select -"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource CustomBlue}"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource CustomDarkBlue}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Border" Property="BorderBrush" Value="DarkGray"/>
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource CustomGray}"/>
                                <Setter Property="Foreground" Value="Gray"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="IconButtonStyle" TargetType="Button">
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Width" Value="35"/>
            <Setter Property="Height" Value="35"/>
            <Setter Property="Foreground" Value="DarkGray"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid ClipToBounds="False" Background="Transparent">
                            <ContentPresenter Name="Icon" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{TemplateBinding Content}"></ContentPresenter>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="Gray"></Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Foreground" Value="Gray"></Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="#FFC9C9C9"></Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <DockPanel>
        <StackPanel DockPanel.Dock="Left" Orientation="Vertical" Margin="10" Background="Yellow">
            <Button Content="Add data" Click="OnAddDataClick" Margin="5 0"/>
            <Button Content="Clear" Click="OnClearClick" Margin="5 0"/>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="PageCount: " Margin="5 0"/>
                <TextBlock x:Name="Pages1" Text="{Binding ElementName=DocumentViewer, Path=PageCount}" Margin="5 0"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Saved pages: " Margin="5 0"/>
                <TextBlock x:Name="txtSavedPages" Text="{Binding Path=SavedPages}" Margin="5 0"/>
            </StackPanel>
            <Button Content="Save to a191.xps" ToolTip="Print" Click="OnSaveToXpsClick" Width="100" Margin="5 0"/>
            <Button Content="Print dialog" ToolTip="Print" Click="OnPrintDialogClick" Width="100" Margin="5 0"/>
        </StackPanel>

        <DocumentViewer x:Name="DocumentViewer" ShowPageBorders="True" BorderBrush="Red" BorderThickness="2">
            <DocumentViewer.Template>
                <ControlTemplate TargetType="DocumentViewer">
                    <Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="40" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Background="#FFDEDEDE">
                                <StackPanel Orientation="Horizontal" Margin="0">
                                    <Button x:Name="Print" Margin="5,0" Style="{StaticResource IconButtonStyle}" ToolTip="Print">
                                        <Path Fill="{Binding ElementName=Print, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0"
                                              Data="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
                                    </Button>

                                    <Grid Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="0 5"/>

                                    <ComboBox x:Name="equipmentComboBox" BorderBrush="Silver" Margin="2" DisplayMemberPath="Name" ToolTip="Printer" FontSize="14" Width="250" VerticalContentAlignment="Center"
                                              SelectionChanged="EquipmentComboBox_SelectionChanged" DropDownOpened="EquipmentComboBox_DropDownOpened"/>

                                    <Button x:Name="PageSetup" Margin="5,0" Style="{StaticResource IconButtonStyle}" ToolTip="Page setup" Click="OnPageSetupClick">
                                        <Path Fill="{Binding ElementName=PageSetup, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0"
                                              Data="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                    </Button>

                                    <Grid Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="0 5"/>

                                    <Button x:Name="ZoomInBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.IncreaseZoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Zoom In">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=ZoomInBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M919.264-9.984l-138.912 138.912C851.808 203.68 896 304.672 896 416c0 229.376-186.624 416-416 416S64 645.376 64 416s186.624-416 416-416c95.008 0 182.432 32.384 252.544 86.208l141.44-141.44a31.904 31.904 0 0 1 45.248 0 32 32 0 0 1 0.032 45.248zM128 416C128 610.08 285.92 768 480 768s352-157.92 352-352-157.92-352-352-352S128 221.92 128 416zM625.792 448H512v112a32 32 0 0 1-64 0V448h-112a32 32 0 0 1 0-64H448v-112a32 32 0 1 1 64 0V384h113.792a32 32 0 1 1 0 64z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>

                                    <Button x:Name="ZoomOutBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.DecreaseZoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Zoom Out">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=ZoomOutBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M919.264-9.984l-138.912 138.912C851.808 203.68 896 304.672 896 416c0 229.376-186.624 416-416 416S64 645.376 64 416s186.624-416 416-416c95.008 0 182.432 32.384 252.544 86.208l141.44-141.44a31.904 31.904 0 0 1 45.248 0 32 32 0 0 1 0.032 45.248zM128 416C128 610.08 285.92 768 480 768s352-157.92 352-352-157.92-352-352-352S128 221.92 128 416zM625.792 448H336a32 32 0 0 1 0-64h289.792a32 32 0 1 1 0 64z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <StackPanel Width="0"></StackPanel>
                                    <Button x:Name="ActualSizeBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.Zoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="100.0" ToolTip="Actual Size" Click="ActualSizeBtn_Click">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=ActualSizeBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112zM368.896 704a32 32 0 0 1-32-32v-105.888H224a32 32 0 0 1 0-64h144.896a32 32 0 0 1 32 32V672a32 32 0 0 1-32 32zM784.864 566.112H672V672a32 32 0 1 1-64 0v-137.888a32 32 0 0 1 32-32h144.864a32 32 0 1 1 0 64zM368.896 256H224a32 32 0 1 1 0-64h112.896v-105.92a32 32 0 1 1 64 0V224a32 32 0 0 1-32 32zM784.864 256H640a32 32 0 0 1-32-32v-137.92a32 32 0 1 1 64 0V192h112.864a32 32 0 1 1 0 64z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="FitToWidthBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToWidthCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Fit To Width">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=FitToWidthBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M368.896 704H224a32 32 0 0 1-32-32v-137.888a32 32 0 0 1 64 0V640h112.896a32 32 0 0 1 0 64zM784.864 704H640a32 32 0 1 1 0-64h112.864v-105.888a32 32 0 1 1 64 0V672a32 32 0 0 1-32 32zM368.896 118.08H256V224a32 32 0 1 1-64 0v-137.92a32 32 0 0 1 32-32h144.896a32 32 0 1 1 0 64zM784.864 256a32 32 0 0 1-32-32v-105.92H640a32 32 0 1 1 0-64h144.864a32 32 0 0 1 32 32V224a32 32 0 0 1-32 32zM912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="FitToMaxOnePagesBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="1" ToolTip="Whole Page">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=FitToMaxOnePagesBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384zM533 646.3c-4.5-1.7-12.3-8.5-28-24.3-28.1-28.2-37.3-34.1-66-41.5-15.5-4.1-23.2-8.7-27.8-16.4-4.9-8.5-3.2-24.2 3.5-32.1 8.5-9.9 24.3-12.3 44.9-6.9 9.1 2.4 25.1 9.3 35.6 15.4 4.3 2.5 8 4.5 8.3 4.5 0.3 0 0.5-88.3 0.5-196.2 0-130.2 0.4-198.4 1-202.7 2-12.2 9.3-21.7 18.5-24 5.9-1.5 19-1.4 24.2 0.2 7.6 2.3 13.1 7 16.6 14.5l3.2 6.7v482l-2.3 5c-2.7 5.8-5.3 8.8-10.2 12-5.8 3.6-17.2 5.6-22 3.8z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="FitToMaxTwoPagesBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="4" ToolTip="Two Pages">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=FitToMaxTwoPagesBtn, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0" Data="M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384zM488.5 640.5c-22.2-3.1-44.3-10.5-61.9-20.7-33.7-19.5-64.4-55.5-75.5-88.4-5.5-16.5-8.7-45.4-6.1-55.1 4.5-16.4 14.6-24.3 31.3-24.3 14.3 0 20.9 8.7 28.6 37.5 2.2 8.3 5 17.4 6.1 20.4 10.6 27.6 32.4 49.7 60 61.1 30.4 12.6 73.1 11.1 102.5-3.5 13.3-6.6 20.7-12.4 27.5-21.3 8.4-11.1 12.3-20.7 14-34.9 3.7-29.2-8.3-58.9-37.5-92.4-9.8-11.2-18.1-18.9-69-63.9-68.4-60.6-94-84.8-120.9-114.4-21.1-23.3-41.5-53.3-46.7-68.6-5.4-16.3-0.8-32.2 11.5-39.4 10.9-6.4 1.9-6 156.6-6.4 92.5-0.2 143.2 0.1 148.3 0.7 10.6 1.4 16.8 4.3 22.2 10.3 5.3 5.9 6.9 11.8 6.3 23.4-0.6 13.3-6.4 21.2-18.6 25.5l-6.7 2.4-115.7 0.5-115.8 0.5 6.2 8c19.7 25.5 57.4 65.2 86.2 90.8 8.8 7.8 18.9 16.9 22.6 20.2 3.6 3.3 13.5 12.1 22 19.5 49.7 43.5 64 57.2 79.5 76.5 18.8 23.4 32.2 50.9 36.6 75.5 1.9 10.3 1.7 37-0.4 48.5-4.6 25.8-15.7 46.6-34.9 65.8-25.9 25.7-58.3 40.6-101.2 46.3-13.3 1.7-44.4 1.7-57.1-0.1z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="FitToMaxFourPagesBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="4" ToolTip="Two Pages">
                                        <Viewbox Width="28" Height="28">
                                            <Path Fill="{Binding ElementName=FitToMaxFourPagesBtn, Path=Foreground}" Stretch="Fill" StrokeThickness="0"
                                                  Data="M 0 0 Z M26 26Z M 13 2 C 6.9367124 2 2 6.9367124 2 13 C 2 19.063287 6.9367123 24 13 24 C 19.063287 24 24 19.063287 24 13 C 24 6.9367123 19.063287 2 13 2 z M 13 4 C 17.982407 4 22 8.0175927 22 13 C 22 17.982407 17.982407 22 13 22 C 8.0175927 22 4 17.982407 4 13 C 4 8.0175926 8.0175926 4 13 4 z M 12.90625 8.90625 C 11.80625 11.20625 9.6125 13.69375 9.3125 14.09375 L 9.3125 15.5 L 12.90625 15.5 L 12.90625 17.1875 L 14.59375 17.1875 L 14.59375 15.5 L 15.59375 15.5 L 15.59375 14.09375 L 14.59375 14.09375 L 14.59375 8.90625 L 12.90625 8.90625 z M 12.90625 11.1875 L 12.90625 14.09375 L 10.90625 14.09375 C 11.10625 13.89375 12.20625 12.5875 12.90625 11.1875 z">
                                            </Path>
                                        </Viewbox>
                                    </Button>
                                    <Button x:Name="xFitToMaxFourPagesBtn" Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="4" ToolTip="Two Pages">
                                        <Viewbox Width="24" Height="24">
                                            <Path Fill="{Binding ElementName=xFitToMaxFourPagesBtn, Path=Foreground}" Stretch="Fill" StrokeThickness="0"
                                                  Data="M 0 0 Z M512 512 Z M 321.355469 108.917969 L 321.355469 304.28125 L 362.164062 304.28125 L 362.164062 334.792969 L 321.355469 334.792969 L 321.355469 403.082031 L 283.789062 403.082031 L 283.789062 334.792969 L 149.835938 334.792969 L 149.835938 312.765625 L 281.554688 108.917969 Z M 279.324219 168.125 L 192.253906 304.28125 L 283.789062 304.28125 L 283.789062 160.03125 Z">
                                            </Path>
                                        </Viewbox>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <Grid Grid.Row="1" Background="#FFDEDEDE">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <WrapPanel x:Name="TopPanel" Grid.Column="0" Orientation="Horizontal" Margin="0" Background="Yellow"
                                           SizeChanged="OnTopPanelSizeChanged">
                                    <Button Margin="5,0" Style="{StaticResource IconButtonStyle}" ToolTip="Print" BorderBrush="Silver" BorderThickness="1" Width="100">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Stretch">
                                        <Viewbox Width="22" Height="22">
                                            <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                  Data="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
                                        </Viewbox>
                                            <TextBlock Text="Print" Margin="8 0 0 0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>

                                    <Grid Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="2 5"/>

                                    <ComboBox BorderBrush="Silver" Margin="4 4" DisplayMemberPath="Name" ToolTip="Printer" FontSize="14" Width="250" VerticalContentAlignment="Center"
                                              SelectionChanged="EquipmentComboBox_SelectionChanged" DropDownOpened="EquipmentComboBox_DropDownOpened"/>

                                    <Button Margin="5 0 0 0" Style="{StaticResource IconButtonStyle}" ToolTip="Print">
                                        <Grid>
                                            <Viewbox Width="22" Height="22">
                                                <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                  Data="M0 0 Z M32 32Z M27.922,10.615c-0.051-0.122-0.124-0.231-0.216-0.323l-7.998-7.998c-0.092-0.092-0.201-0.165-0.323-0.216  C19.264,2.027,19.134,2,19,2H5C4.448,2,4,2.448,4,3s0.448,1,1,1h13v7c0,0.552,0.447,1,1,1h7v16H6V7c0-0.552-0.448-1-1-1S4,6.448,4,7  v22c0,0.553,0.448,1,1,1h22c0.553,0,1-0.447,1-1V11C28,10.867,27.973,10.736,27.922,10.615z M20,5.414L24.586,10H20V5.414z"/>
                                            </Viewbox>
                                            <Viewbox Width="12" Height="12" VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                      Data="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                            </Viewbox>
                                        </Grid>
                                    </Button>
                                    <Button Margin="5 0 0 0" Style="{StaticResource IconButtonStyle}" ToolTip="Print">
                                        <Viewbox Width="22" Height="22">
                                            <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                  Data="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                        </Viewbox>
                                    </Button>
                                    <Button Margin="5 0 0 0" Style="{StaticResource IconButtonStyle}" ToolTip="Print">
                                        <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Width="20" Height="20" Stretch="Fill" StrokeThickness="0"
                                              Data="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                    </Button>

                                    <Grid Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="2 5"/>

                                    <Button Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.IncreaseZoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Zoom In">
                                        <Viewbox Width="22" Height="22">
                                            <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                  Data="M0 0Z M16 16Z M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>
                                        </Viewbox>
                                    </Button>

                                    <Button Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.IncreaseZoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Zoom In">
                                        <Viewbox Width="22" Height="22">
                                            <Path Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" Stretch="Fill"
                                                  Data="M0 0 Z M16 16Z M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z M3 6.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
                                        </Viewbox>
                                    </Button>

                                    <Grid Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="2 5"/>

                                    <Button Style="{StaticResource IconButtonStyle}" Command="NavigationCommands.Zoom" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="100.0" ToolTip="Actual Size" Click="ActualSizeBtn_Click">
                                        <Viewbox Width="22" Height="22" VerticalAlignment="Center">
                                            <Path Stretch="Fill"  Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0 Z M912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112zM368.896 704a32 32 0 0 1-32-32v-105.888H224a32 32 0 0 1 0-64h144.896a32 32 0 0 1 32 32V672a32 32 0 0 1-32 32zM784.864 566.112H672V672a32 32 0 1 1-64 0v-137.888a32 32 0 0 1 32-32h144.864a32 32 0 1 1 0 64zM368.896 256H224a32 32 0 1 1 0-64h112.896v-105.92a32 32 0 1 1 64 0V224a32 32 0 0 1-32 32zM784.864 256H640a32 32 0 0 1-32-32v-137.92a32 32 0 1 1 64 0V192h112.864a32 32 0 1 1 0 64z"/>
                                        </Viewbox>
                                    </Button>
                                    <Button Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToWidthCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" ToolTip="Fit To Width">
                                        <Viewbox Width="22" Height="22">
                                            <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0Z M368.896 704H224a32 32 0 0 1-32-32v-137.888a32 32 0 0 1 64 0V640h112.896a32 32 0 0 1 0 64zM784.864 704H640a32 32 0 1 1 0-64h112.864v-105.888a32 32 0 1 1 64 0V672a32 32 0 0 1-32 32zM368.896 118.08H256V224a32 32 0 1 1-64 0v-137.92a32 32 0 0 1 32-32h144.896a32 32 0 1 1 0 64zM784.864 256a32 32 0 0 1-32-32v-105.92H640a32 32 0 1 1 0-64h144.864a32 32 0 0 1 32 32V224a32 32 0 0 1-32 32zM912 848h-800c-35.296 0-64-28.704-64-64v-800c0-35.296 28.704-64 64-64h800c35.296 0 64 28.704 64 64v800c0 35.296-28.704 64-64 64z m-800-864v800h800l0.064-800H112z"/>
                                        </Viewbox>
                                    </Button>
                                    <!-- One -->
                                    <Button Margin="0,0, 0, 0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="1" ToolTip="Whole Page">
                                        <Viewbox Width="22" Height="22">
                                            <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0Z M 565.757812 127.601562 L 565.757812 646.539062 L 499.746094 646.539062 L 499.746094 209.203125 L 367.449219 257.773438 L 367.449219 198.226562 L 555.472656 127.601562 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z " RenderTransformOrigin="0.5,0.5"/>
                                        </Viewbox>
                                    </Button>
                                    <!-- Two -->
                                    <Button Margin="0,0, 0, 0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="1" ToolTip="Whole Page">
                                        <Viewbox Width="22" Height="22">
                                            <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0Z M 699.085938 595.292969 L 699.085938 648.84375 L 360.691406 648.84375 L 360.691406 601.65625 L 539.484375 403.03125 C 565.960938 373.019531 584.21875 348.609375 594.257812 329.804688 C 604.332031 311 609.371094 291.539062 609.371094 271.425781 C 609.371094 244.488281 601.203125 222.378906 584.871094 205.09375 C 568.578125 187.84375 546.820312 179.21875 519.601562 179.21875 C 486.972656 179.21875 461.613281 188.496094 443.511719 207.054688 C 425.449219 225.613281 416.417969 251.453125 416.417969 284.574219 L 350.773438 284.574219 C 350.773438 237.03125 366.082031 198.609375 396.695312 169.304688 C 427.339844 139.964844 468.308594 125.292969 519.601562 125.292969 C 567.605469 125.292969 605.570312 137.894531 633.496094 163.097656 C 661.386719 188.269531 675.332031 221.777344 675.332031 263.632812 C 675.332031 314.464844 642.933594 375 578.140625 445.234375 L 439.800781 595.292969 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z " RenderTransformOrigin="0.5,0.5"/>
                                        </Viewbox>
                                    </Button>
                                    <!-- Four -->
                                    <Button Margin="0,0, 0, 0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="1" ToolTip="Whole Page">
                                        <Viewbox Width="22" Height="22">
                                            <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0Z M 613.160156 123.542969 L 613.160156 466.550781 L 684.796875 466.550781 L 684.796875 520.105469 L 613.160156 520.105469 L 613.160156 639.992188 L 547.199219 639.992188 L 547.199219 520.105469 L 312.042969 520.105469 L 312.042969 481.449219 L 543.277344 123.542969 Z M 539.351562 227.46875 L 386.488281 466.550781 L 547.199219 466.550781 L 547.199219 213.3125 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z " RenderTransformOrigin="0.5,0.5"/>
                                        </Viewbox>
                                    </Button>

                                    <Grid x:Name="LastElement" Width="1" VerticalAlignment="Stretch" Background="Silver" Margin="2 5 0 5"/>

                                    <StackPanel x:Name="Right" Orientation="Horizontal" HorizontalAlignment="Right" Margin="100 0 0 0">
                                        <!-- Four -->
                                        <Button Margin="0,0, 0, 0" Style="{StaticResource IconButtonStyle}" ToolTip="Test" HorizontalAlignment="Right">
                                            <Viewbox Width="22" Height="22">
                                                <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                      Data="M0 0Z M 613.160156 123.542969 L 613.160156 466.550781 L 684.796875 466.550781 L 684.796875 520.105469 L 613.160156 520.105469 L 613.160156 639.992188 L 547.199219 639.992188 L 547.199219 520.105469 L 312.042969 520.105469 L 312.042969 481.449219 L 543.277344 123.542969 Z M 539.351562 227.46875 L 386.488281 466.550781 L 547.199219 466.550781 L 547.199219 213.3125 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z " RenderTransformOrigin="0.5,0.5"/>
                                            </Viewbox>
                                        </Button>
                                    </StackPanel>

                                </WrapPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <!-- Four -->
                                    <Button Margin="0" Style="{StaticResource IconButtonStyle}" Command="DocumentViewer.FitToMaxPagesAcrossCommand" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="1" ToolTip="Whole Page"
                                            HorizontalAlignment="Right">
                                        <Viewbox Width="22" Height="22">
                                            <Path Stretch="Fill" Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                                                  Data="M0 0Z M 613.160156 123.542969 L 613.160156 466.550781 L 684.796875 466.550781 L 684.796875 520.105469 L 613.160156 520.105469 L 613.160156 639.992188 L 547.199219 639.992188 L 547.199219 520.105469 L 312.042969 520.105469 L 312.042969 481.449219 L 543.277344 123.542969 Z M 539.351562 227.46875 L 386.488281 466.550781 L 547.199219 466.550781 L 547.199219 213.3125 Z M112 830.4c-22.8-6.1-40.7-24.1-46.5-46.9-1.3-5.5-1.5-48.3-1.3-402l0.3-396 2.6-6.7c7.5-19.2 20.5-32.2 39.7-39.7l6.7-2.6h797l6.7 2.6c19.2 7.5 32.2 20.5 39.7 39.7l2.6 6.7v797l-2.6 6.7c-7.5 19.2-20.5 32.2-39.7 39.7l-6.7 2.6-396.5 0.2c-346.2 0.2-397.2 0-402-1.3zM896 384v-384H128V768h768v-384z " RenderTransformOrigin="0.5,0.5"/>
                                        </Viewbox>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <ScrollViewer x:Name="PART_ContentHost" Grid.Row="2" Cursor="Arrow" CanContentScroll="True" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" IsTabStop="True" Background="#FFE8E8E8" PanningMode="VerticalOnly" ManipulationBoundaryFeedback="DocumentPreviewer_ManipulationBoundaryFeedback"></ScrollViewer>

                            <ContentControl x:Name="PART_FindToolBarHost" Visibility="Collapsed"/>

                            <Grid Grid.Row="3" Background="#FFDEDEDE">
                                <StackPanel Margin="8,0" HorizontalAlignment="Left" Orientation="Horizontal">
                                    <TextBlock x:Name="currentPageTextBlock" VerticalAlignment="Center" FontSize="14" Foreground="Gray" Text="Page 1 / 1"></TextBlock>
                                </StackPanel>
                                <StackPanel Margin="8,0" HorizontalAlignment="Right" Orientation="Horizontal">
                                    <Button x:Name="FirstPageBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CanGoToPreviousPage}" ToolTip="First Page" Click="FirstPageBtn_Click">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=FirstPageBtn, Path=Foreground}" Width="14" Height="17.5" Stretch="Fill" StrokeThickness="0" Data="M768 617.376l-45.248 45.248L444.128 384l278.624-278.624L768 150.624 534.624 384zM288 64h64V704H288z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="PreviousPageBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CanGoToPreviousPage}" ToolTip="Previous Page" Click="PreviousPageBtn_Click">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=PreviousPageBtn, Path=Foreground}" Width="9" Height="15.5" Stretch="Fill" StrokeThickness="0" Data="M589.088 105.376L310.464 384l278.624 278.624 45.248-45.248L400.96 384l233.376-233.376z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="NextPageBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CanGoToNextPage}" ToolTip="Next Page" Click="NextPageBtn_Click">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=NextPageBtn, Path=Foreground}" Width="9" Height="15.5" Stretch="Fill" StrokeThickness="0" Data="M434.944 105.376l-45.248 45.248L623.04 384l-233.376 233.376 45.248 45.248L713.568 384z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="LastPageBtn" Margin="5,0" Style="{StaticResource IconButtonStyle}" IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CanGoToNextPage}" ToolTip="Last Page" Click="LastPageBtn_Click">
                                        <Button.Content>
                                            <Path Fill="{Binding ElementName=LastPageBtn, Path=Foreground}" Width="14" Height="17.5" Stretch="Fill" StrokeThickness="0" Data="M256 617.376L489.376 384 256 150.624l45.248-45.248L579.872 384 301.248 662.624zM672 64h64V704h-64z" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <RotateTransform Angle="180"/>
                                                        <ScaleTransform ScaleX="-1"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </DocumentViewer.Template>
            <DocumentViewer.InputBindings>
                <KeyBinding Key="P" Modifiers="Control" Command="ApplicationCommands.NotACommand" />
            </DocumentViewer.InputBindings>
        </DocumentViewer>
    </DockPanel>

</UserControl>
